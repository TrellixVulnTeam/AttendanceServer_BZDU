{% extends 'hod_template/base_template.html' %}

{% block main_content %}

    {% load static %}

    <section class="content">
        <div class="container-fluid">
            <!-- Small boxes (Stat box) -->
            <div class="row">
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-info">
                        <div class="inner">
                            <h3>{{ all_student_count }}</h3>

                            <p>Total Students</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        <a href="{% url 'manage_student' %}" class="small-box-footer">More info <i
                                class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>


                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-warning">
                        <div class="inner">
                            <h3>{{ course_count }}</h3>

                            <p>Total Courses</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        <a href="{% url 'manage_course' %}" class="small-box-footer">More info <i
                                class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->
                <div class="col-lg-3 col-6">
                    <!-- small box -->
                    <div class="small-box bg-success">
                        <div class="inner">
                            <h3>{{ lecturer_count }}</h3>

                            <p>Total Lecturers</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        <a href="{% url 'manage_lecturer' %}" class="small-box-footer">More info <i
                                class="fas fa-arrow-circle-right"></i></a>
                    </div>
                </div>
                <!-- ./col -->

            </div>

            {#        #}
            <div class="row">
                <div class="col-lg-12">
                    <!-- BAR CHART -->
                    <div class="card card-success">
                        <div class="card-header">
                            <h3 class="card-title">Student Details</h3>

                            <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse"><i
                                        class="fas fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-tool" data-card-widget="remove"><i
                                        class="fas fa-times"></i></button>
                            </div>
                        </div>
                        <div class="card-body table-responsive p-0">
                            <table class="table table-hover text-nowrap">
                                <thead>
                                <tr>
                                    <th>Student Code</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Major</th>
                                    <th>Avatar</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for student in students %}

                                    <tr>
                                        <td>{{ student.code_user }}</td>
                                        <td>{{ student.name }}</td>
                                        <td>{{ student.email }}</td>

                                        <td>{{ student.major }}</td>
                                        <td><img src="{{ student.url_avatar }}" style="width: 50px;"/></td>

                                    </tr>
                                {% endfor %}

                                </tbody>
                            </table>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>


                <div class="col-lg-6">

                </div>

            </div>
            {#        #}
            {#        #}
            <div class="row">
                <div class="col-lg-12">
                    <!-- BAR CHART -->
                    <div class="card card-success">
                        <div class="card-header">
                            <h3 class="card-title">Courses Details</h3>

                            <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse"><i
                                        class="fas fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-tool" data-card-widget="remove"><i
                                        class="fas fa-times"></i></button>
                            </div>
                        </div>
                        <div class="card-body table-responsive p-0">
                            <table class="table table-hover text-nowrap">
                                <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Course Name</th>
                                    <th>Lecturer</th>
                                    <th>Created At</th>
                                    <th>End At</th>

                                </tr>
                                </thead>
                                <tbody>
                                {% for course in courses %}
                                    <tr>
                                        <td>{{ course.code }}</td>
                                        <td>{{ course.name }}</td>
                                        <td>{{ course.lecturer }}</td>
                                        <td>{{ course.start }}</td>
                                        <td>{{ course.end }}</td>

                                    </tr>
                                {% endfor %}

                                </tbody>
                            </table>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>


                <div class="col-lg-6">

                </div>

            </div>
            {#        #}

            <div class="row">
                <div class="col-lg-12">
                    <!-- BAR CHART -->
                    <div class="card card-success">
                        <div class="card-header">
                            <h3 class="card-title">Lecturer Details</h3>

                            <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse"><i
                                        class="fas fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-tool" data-card-widget="remove"><i
                                        class="fas fa-times"></i></button>
                            </div>
                        </div>
                        <div class="card-body table-responsive p-0">
                            <table class="table table-hover text-nowrap">
                                <thead>
                                <tr>
                                    <th>Lecturer Code</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Major</th>
                                    <th>Avatar</th>

                                </tr>
                                </thead>
                                <tbody>
                                {% for lecture in lecturers %}
                                    <tr>
                                        <td>{{ lecture.code_user }}</td>
                                        <td>{{ lecture.name }}</td>
                                        <td>{{ lecture.email }}</td>

                                        <td>{{ lecture.major }}</td>
                                        <td><img src="{{ lecture.url_avatar }}" style="width: 50px;"/></td>
                                        {#                                        <td>#}
                                        {#                                            <a href="{% url 'edit_subject' lecture.id %}"#}
                                        {#                                               class="btn btn-success">Edit</a>#}
                                        {#                                            <a href="{% url 'delete_subject' lecture.id %}" class="btn btn-danger">Delete</a>#}
                                        {#                                        </td>#}
                                    </tr>
                                {% endfor %}

                                </tbody>
                            </table>
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.card -->
                </div>


                <div class="col-lg-6">

                </div>


            </div>

        </div><!-- /.container-fluid -->
    </section>

{% endblock main_content %}

{% block custom_js %}

    <script>
        $(document).ready(function () {
            var donutChartCanvas = $('#pieChart').get(0).getContext('2d')
            var pieData = {
                labels: [
                    'Students',
                    'Staffs',
                ],
                datasets: [
                    {
                        data: [{{ all_student_count }}, {{ staff_count }}],
                        backgroundColor: ['#f56954', '#00a65a'],
                    }
                ]
            }

            //-------------
            //- PIE CHART -
            //-------------
            // Get context with jQuery - using jQuery's .get() method.
            var pieChartCanvas = $('#pieChart').get(0).getContext('2d')
            var pieData = pieData;
            var pieOptions = {
                maintainAspectRatio: false,
                responsive: true,
            }
            //Create pie or douhnut chart
            // You can switch between pie and douhnut using the method below.
            var pieChart = new Chart(pieChartCanvas, {
                type: 'pie',
                data: pieData,
                options: pieOptions
            })


            // Get context with jQuery - using jQuery's .get() method.
            var course_name_list =
            {{ course_name_list|safe }}
            var subject_count_list =
            {{ subject_count_list }}
            var donutChartCanvas = $('#donutChart').get(0).getContext('2d')
            var donutData = {
                labels: course_name_list,
                datasets: [
                    {
                        data: subject_count_list,
                        backgroundColor: ['#f56954', '#00a65a', '#f39c12', '#00c0ef', '#3c8dbc', '#d2d6de'],
                    }
                ]
            }
            var donutOptions = {
                maintainAspectRatio: false,
                responsive: true,
            }
            //Create pie or douhnut chart
            // You can switch between pie and douhnut using the method below.
            var donutChart = new Chart(donutChartCanvas, {
                type: 'doughnut',
                data: donutData,
                options: donutOptions
            })


            // Total Students in Each Course
            //var donutChartCanvas = $('#pieChart2').get(0).getContext('2d')
            var student_count_list_in_course =
            {{ student_count_list_in_course }}
            var pieData2 = {
                labels: course_name_list,
                datasets: [
                    {
                        data: student_count_list_in_course,
                        backgroundColor: ['#f56954', '#00a65a', '#f39c12', '#00c0ef', '#3c8dbc', '#d2d6de'],
                    }
                ]
            }

            //-------------
            //- PIE CHART -
            //-------------
            // Get context with jQuery - using jQuery's .get() method.
            var pieChartCanvas2 = $('#pieChart2').get(0).getContext('2d')
            var pieData2 = pieData2;
            var pieOptions2 = {
                maintainAspectRatio: false,
                responsive: true,
            }

            var pieChart2 = new Chart(pieChartCanvas2, {
                type: 'pie',
                data: pieData2,
                options: pieOptions2
            })

            // Total Students in Each Subject
            var student_count_list_in_subject =
            {{ student_count_list_in_subject }}
            var subject_list =
            {{ subject_list|safe }}
            var pieData3 = {
                labels: subject_list,
                datasets: [
                    {
                        data: student_count_list_in_subject,
                        backgroundColor: ['#f56954', '#00a65a', '#f39c12', '#00c0ef', '#3c8dbc', '#d2d6de'],
                    }
                ]
            }

            //-------------
            //- PIE CHART -
            //-------------
            // Get context with jQuery - using jQuery's .get() method.
            var pieChartCanvas3 = $('#pieChart3').get(0).getContext('2d')
            var pieData3 = pieData3;
            var pieOptions3 = {
                maintainAspectRatio: false,
                responsive: true,
            }

            var pieChart3 = new Chart(pieChartCanvas3, {
                type: 'pie',
                data: pieData3,
                options: pieOptions3
            })

            //-------------
            //- BAR CHART - Staff Attendance vs Leave
            //-------------

            var staff_attendance_present_list = {{ staff_attendance_present_list }};
            var staff_attendance_leave_list = {{ staff_attendance_leave_list }};
            var staff_name_list = {{ staff_name_list|safe }};

            var areaChartData = {
                labels: staff_name_list,
                datasets: [
                    {
                        label: 'Leave',
                        backgroundColor: 'rgba(60,141,188,0.9)',
                        borderColor: 'rgba(60,141,188,0.8)',
                        pointRadius: false,
                        pointColor: '#3b8bba',
                        pointStrokeColor: 'rgba(60,141,188,1)',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: 'rgba(60,141,188,1)',
                        data: staff_attendance_leave_list
                    },
                    {
                        label: 'Attendance',
                        backgroundColor: 'rgba(210, 214, 222, 1)',
                        borderColor: 'rgba(210, 214, 222, 1)',
                        pointRadius: false,
                        pointColor: 'rgba(210, 214, 222, 1)',
                        pointStrokeColor: '#c1c7d1',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: 'rgba(220,220,220,1)',
                        data: staff_attendance_present_list
                    },
                ]
            }


            var barChartCanvas = $('#barChart').get(0).getContext('2d')
            var barChartData = jQuery.extend(true, {}, areaChartData)
            var temp0 = areaChartData.datasets[0]
            var temp1 = areaChartData.datasets[1]
            barChartData.datasets[0] = temp1
            barChartData.datasets[1] = temp0

            var barChartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                datasetFill: false
            }

            var barChart = new Chart(barChartCanvas, {
                type: 'bar',
                data: barChartData,
                options: barChartOptions
            })


            //- BAR CHART - Student Attendance vs Leave
            //-------------

            var student_attendance_present_list = {{ student_attendance_present_list }};
            var student_attendance_leave_list = {{ student_attendance_leave_list }};
            var student_name_list = {{ student_name_list|safe }};

            var areaChartData2 = {
                labels: student_name_list,
                datasets: [
                    {
                        label: 'Leave',
                        backgroundColor: 'rgba(60,141,188,0.9)',
                        borderColor: 'rgba(60,141,188,0.8)',
                        pointRadius: false,
                        pointColor: '#3b8bba',
                        pointStrokeColor: 'rgba(60,141,188,1)',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: 'rgba(60,141,188,1)',
                        data: student_attendance_leave_list
                    },
                    {
                        label: 'Attendance',
                        backgroundColor: 'rgba(210, 214, 222, 1)',
                        borderColor: 'rgba(210, 214, 222, 1)',
                        pointRadius: false,
                        pointColor: 'rgba(210, 214, 222, 1)',
                        pointStrokeColor: '#c1c7d1',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: 'rgba(220,220,220,1)',
                        data: student_attendance_present_list
                    },
                ]
            }


            var barChartCanvas2 = $('#barChart2').get(0).getContext('2d')
            var barChartData2 = jQuery.extend(true, {}, areaChartData2)
            var temp02 = areaChartData2.datasets[0]
            var temp12 = areaChartData2.datasets[1]
            barChartData2.datasets[0] = temp12
            barChartData2.datasets[1] = temp02

            var barChartOptions2 = {
                responsive: true,
                maintainAspectRatio: false,
                datasetFill: false
            }

            var barChart2 = new Chart(barChartCanvas2, {
                type: 'bar',
                data: barChartData2,
                options: barChartOptions2
            })

        })
    </script>

{% endblock custom_js %}